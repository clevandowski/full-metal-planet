<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="css/styles.css?v=1.0">
		<script type="text/javascript" src="scripts/jquery-2.1.3.js"></script>
		<script type="text/javascript" src="scripts/angular.js"></script>
		<script type="text/javascript" src="scripts/plateau.js"></script>
	</head>
	<body style="overflow: hidden">
		<div ng-app="myApp" ng-controller="myCtrl">

			<!-- Voir la directive hexagonalCase associée -->
<!-- 			<label>Marée: <select 
				ng-model="currentMaree" 
				ng-options="maree.value as maree.name for maree in marees">
			</select></label> -->
			<div id="info-partie">
				<span class="info">JOUEUR: {{partie.getPlayer().name}}</span><br/>
				<span class="info">POINTS: {{partie.tourPoints}}</span><span ng-show="partie.getPlayer().pointsEconomise > 0"> (+{{partie.getPlayer().pointsEconomise}})</span><br/>
				<span class="info">MAR&Eacute;E: {{partie.currentMaree.name}}</span><br/>
				<span class="info">SUIVANTE: {{partie.nextMaree.name}}</span><br/>
			</div>
			<div id="soute" class="soute">
				<div class="soute-container piece {{piece.pieceType.cssName}} {{engine.cssSelectedPieceSoute(piece)}}" 
					ng-repeat="piece in engine.getSelectedPiece().contenu" ng-click="engine.onClickSoute(piece)">
				</div>
			</div>
			<div id="fin-tour" ng-click="partie.setTourToNextPlayer(false); engine.centerPlateau()">
				<span>FIN DU TOUR</span><br/>
				<span ng-show="partie.tourPoints <= 0">CLIC ! CLIC !</span>
			</div>
			<div class="container" id="container">
				<div class="plateau" id="plateau">
					<div class="hexagon-row" ng-repeat="ligne in plateau">
						<div class="hexagon-case {{hexagonalCase.getCaseTypeMaree(partie.currentMaree).cssName}} {{engine.cssSelectedPiece(hexagonalCase)}}" ng-repeat="hexagonalCase in ligne" ng-click="GameEventListener.hi(); engine.onClick(hexagonalCase, partie.currentMaree)">
							<!-- {{hexagonalCase.x}}, {{hexagonalCase.y}} -->
							<div class="explosion" ng-show="hexagonalCase.explose"></div>
							<div ng-show="engine.getPieceIfAvailable(hexagonalCase)" class="piece {{engine.getPieceIfAvailable(hexagonalCase).pieceType.cssName}} {{engine.getPieceIfAvailable(hexagonalCase).orientation.cssName}}" right-click="hexagonalCase" coord-x="{{hexagonalCase.x}}" coord-y="{{hexagonalCase.y}}">
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script type="text/javascript">
			// Récupération de l'application myApp (ne pas oublier de la déclarer 
			// dans le html)
			var app = angular.module('myApp', []);

			app.factory('GameEventListener', [ '$window', function($window) {
				return {
					hi: function() {
      					$window.alert('Hello');
    				}
				}
			}]);
			// Définition du controller myCtrl (ne pas oublier de la déclarer dans le html)
			app.controller('myCtrl', ['$scope', 'GameEventListener', function($scope, GameEventListener) {
				$scope.marees = MAREES;
				// $scope.currentMaree = $scope.marees[1].value;

				$scope.plateau = initPlateau(PLATEAU);
				$scope.partie = new Partie($scope.plateau);
				$scope.engine = new Engine($scope.partie);
				$scope.GameEventListener = GameEventListener;
				// GameEventListener.hi();
				// $scope.explosionTimer = function() { setTimeout(f)}
			}]);
			// app.directive('rightClick',function() {
			//     document.oncontextmenu = function (e) {
			//        if(e.target.hasAttribute('right-click')) {
			//            return false;
			//        }
			//     };
			//     return function(scope, el, attrs) {
			//         el.bind('contextmenu',function(e) {
			//             scope.engine.onRightClick(attrs.coordX, attrs.coordY);
			//             scope.$apply();
			//         }) ;
			//     }
			// });
		</script>
	</body>
</html>
